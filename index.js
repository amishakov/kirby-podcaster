parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"kK6Q":[function(require,module,exports) {
"use strict";function e(e,t){if(t.length<e)throw new TypeError(e+" argument"+e>1?"s":" required, but only "+t.length+" present")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"KYJg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=r;var e=t(require("../_lib/requiredArgs/index.js"));function t(e){return e&&e.__esModule?e:{default:e}}function r(t){(0,e.default)(1,arguments);var r=Object.prototype.toString.call(t);return t instanceof Date||"object"==typeof t&&"[object Date]"===r?new Date(t.getTime()):"number"==typeof t||"[object Number]"===r?new Date(t):("string"!=typeof t&&"[object String]"!==r||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}
},{"../_lib/requiredArgs/index.js":"kK6Q"}],"UfcY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=u;var e=r(require("../toDate/index.js")),t=r(require("../_lib/requiredArgs/index.js"));function r(e){return e&&e.__esModule?e:{default:e}}function u(r){return(0,t.default)(1,arguments),(0,e.default)(r).getMonth()}
},{"../toDate/index.js":"KYJg","../_lib/requiredArgs/index.js":"kK6Q"}],"VYL5":[function(require,module,exports) {
"use strict";function e(e){if(null===e||!0===e||!1===e)return NaN;var r=Number(e);return isNaN(r)?r:r<0?Math.ceil(r):Math.floor(r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"d11T":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=u;var e=r(require("../toDate/index.js")),t=r(require("../_lib/requiredArgs/index.js"));function r(e){return e&&e.__esModule?e:{default:e}}function u(r){(0,t.default)(1,arguments);var u=(0,e.default)(r),a=u.getFullYear(),l=u.getMonth(),s=new Date(0);return s.setFullYear(a,l+1,0),s.setHours(0,0,0,0),s.getDate()}
},{"../toDate/index.js":"KYJg","../_lib/requiredArgs/index.js":"kK6Q"}],"atx5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=a;var e=n(require("../_lib/toInteger/index.js")),t=n(require("../toDate/index.js")),r=n(require("../getDaysInMonth/index.js")),u=n(require("../_lib/requiredArgs/index.js"));function n(e){return e&&e.__esModule?e:{default:e}}function a(n,a){(0,u.default)(2,arguments);var i=(0,t.default)(n),s=(0,e.default)(a),l=i.getMonth()+s,d=new Date(0);d.setFullYear(i.getFullYear(),l,1),d.setHours(0,0,0,0);var o=(0,r.default)(d);return i.setMonth(l,Math.min(o,i.getDate())),i}
},{"../_lib/toInteger/index.js":"VYL5","../toDate/index.js":"KYJg","../getDaysInMonth/index.js":"d11T","../_lib/requiredArgs/index.js":"kK6Q"}],"Aqc8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=d;var e=u(require("../_lib/toInteger/index.js")),r=u(require("../addMonths/index.js")),t=u(require("../_lib/requiredArgs/index.js"));function u(e){return e&&e.__esModule?e:{default:e}}function d(u,d){(0,t.default)(2,arguments);var i=(0,e.default)(d);return(0,r.default)(u,-i)}
},{"../_lib/toInteger/index.js":"VYL5","../addMonths/index.js":"atx5","../_lib/requiredArgs/index.js":"kK6Q"}],"y4KC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=u;var e=t(require("../toDate/index.js")),r=t(require("../_lib/requiredArgs/index.js"));function t(e){return e&&e.__esModule?e:{default:e}}function u(t){return(0,r.default)(1,arguments),(0,e.default)(t).getFullYear()}
},{"../toDate/index.js":"KYJg","../_lib/requiredArgs/index.js":"kK6Q"}],"w6LP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=a(require("date-fns/getMonth")),e=a(require("date-fns/addMonths")),r=a(require("date-fns/subMonths")),n=a(require("date-fns/getYear"));function a(t){return t&&t.__esModule?t:{default:t}}var s={data:function(){return{currentDate:new Date,currentMonthName:null,currentMonth:null,currentYear:null,headline:null,episodes:[],error:null,podcasterSlug:null}},created:function(){this.setNewDateVars()},mounted:function(){this.podcasterSlug=this.sanitizeTitle(this.pageValues.podcastertitle),this.getStats()},computed:{pageValues:function(){return this.$store.getters["content/values"](this.id)}},watch:{currentDate:{immediate:!1,handler:function(t,e){this.getStats()}}},methods:{getStats:function(){var t=this;fetch("/api/podcaster/stats/"+this.podcasterSlug+"/year/"+this.currentYear+"/month/"+(this.currentMonth+1),{method:"GET",headers:{"X-CSRF":panel.csrf}}).then(function(t){if(200!==t.status)throw"You are tracking your downloads, using the file method. Stats are currently available only when using mysql";return t}).then(function(t){return t.json()}).then(function(e){t.episodes=t.computeStats(e.stats)}).catch(function(e){t.error=e,console.log(t.error)})},computeStats:function(t){return t.episodes.map(function(t){return{text:t.episode.replace(/-/g," "),info:t.downloaded}})},prevMonth:function(){var t=(0,r.default)(this.currentDate,1);this.currentDate=t,this.setNewDateVars()},nextMonth:function(){var t=(0,e.default)(this.currentDate,1);this.currentDate=t,this.setNewDateVars()},setNewDateVars:function(){this.currentMonth=(0,t.default)(this.currentDate),this.currentYear=(0,n.default)(this.currentDate),this.currentMonthName=this.currentDate.toLocaleString("en",{month:"long"}),this.headline="Stats for "+this.currentMonthName+" "+this.currentYear},sanitizeTitle:function(t){return t.toLowerCase().replace(/e|é|è|ẽ|ẻ|ẹ|ê|ế|ề|ễ|ể|ệ/gi,"e").replace(/a|á|à|ã|ả|ạ|ă|ắ|ằ|ẵ|ẳ|ặ|â|ấ|ầ|ẫ|ẩ|ậ/gi,"a").replace(/o|ó|ò|õ|ỏ|ọ|ô|ố|ồ|ỗ|ổ|ộ|ơ|ớ|ờ|ỡ|ở|ợ/gi,"o").replace(/u|ú|ù|ũ|ủ|ụ|ư|ứ|ừ|ữ|ử|ự/gi,"u").replace(/đ/gi,"d").replace(/\s*$/g,"").replace(/\s+/g,"-")}}};exports.default=s;
(function(){var t=exports.default||module.exports;"function"==typeof t&&(t=t.options),Object.assign(t,{render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"k-modified-section"},[n("div",{staticClass:"podcaster-prev-next"},[n("button",{staticClass:"k-link k-button",on:{click:t.prevMonth}},[n("k-icon",{attrs:{type:"angle-left"}})],1),t._v(" "),n("button",{staticClass:"k-link k-button",on:{click:t.nextMonth}},[n("k-icon",{attrs:{type:"angle-right"}})],1)]),t._v(" "),n("k-text",[t._v(t._s(t.error))]),t._v(" "),n("k-headline",[t._v(t._s(t.headline))]),t._v(" "),n("k-list",{attrs:{items:t.episodes}})],1)},staticRenderFns:[],_compiled:!0,_scopeId:null,functional:void 0});})();
},{"date-fns/getMonth":"UfcY","date-fns/addMonths":"atx5","date-fns/subMonths":"Aqc8","date-fns/getYear":"y4KC"}],"PwSu":[function(require,module,exports) {
"use strict";function t(t,e){return"string"==typeof t?(e||document).querySelector(t):t||null}function e(t){let e=t.getBoundingClientRect();return{top:e.top+(document.documentElement.scrollTop||document.body.scrollTop),left:e.left+(document.documentElement.scrollLeft||document.body.scrollLeft)}}function s(t){var e=t.getBoundingClientRect();return e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth)}function i(t){var e=window.getComputedStyle(t),s=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight);return t.clientWidth-s}function a(t,e,s){var i=document.createEvent("HTMLEvents");for(var a in i.initEvent(e,!0,!0),s)i[a]=s[a];return t.dispatchEvent(i)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.AxisChart=exports.Heatmap=exports.PieChart=exports.PercentageChart=exports.Chart=void 0,t.create=((e,s)=>{var i=document.createElement(e);for(var a in s){var n=s[a];if("inside"===a)t(n).appendChild(i);else if("around"===a){var r=t(n);r.parentNode.insertBefore(i,r),i.appendChild(r)}else"styles"===a?"object"==typeof n&&Object.keys(n).map(t=>{i.style[t]=n[t]}):a in i?i[a]=n:i.setAttribute(a,n)}return i});const n={margins:{top:10,bottom:10,left:20,right:20},paddings:{top:20,bottom:40,left:30,right:10},baseHeight:240,titleHeight:20,legendHeight:30,titleFontSize:12};function r(t){return t.titleHeight+t.margins.top+t.paddings.top}function o(t){return t.margins.left+t.paddings.left}function l(t){return t.margins.top+t.margins.bottom+t.paddings.top+t.paddings.bottom+t.titleHeight+t.legendHeight}function h(t){return t.margins.left+t.margins.right+t.paddings.left+t.paddings.right}const d=700,c=400,p="line",u=["line","bar"],m=100,g=.5,f=0,y=4,x=4,b=20,v=2,w=5,A=10,k=2,L=7,P=5,T=["light-blue","blue","violet","red","orange","yellow","green","light-green","purple","magenta","light-grey","dark-grey"],M=["#ebedf0","#c6e48b","#7bc96f","#239a3b","#196127"],C={bar:T,line:T,pie:T,percentage:T,heatmap:M,donut:T},D=Math.PI/180,$=360;class N{constructor({parent:t=null,colors:e=[]}){this.parent=t,this.colors=e,this.titleName="",this.titleValue="",this.listValues=[],this.titleValueFirst=0,this.x=0,this.y=0,this.top=0,this.left=0,this.setup()}setup(){this.makeTooltip()}refresh(){this.fill(),this.calcPosition()}makeTooltip(){this.container=t.create("div",{inside:this.parent,className:"graph-svg-tip comparison",innerHTML:'<span class="title"></span>\n\t\t\t\t<ul class="data-point-list"></ul>\n\t\t\t\t<div class="svg-pointer"></div>'}),this.hideTip(),this.title=this.container.querySelector(".title"),this.dataPointList=this.container.querySelector(".data-point-list"),this.parent.addEventListener("mouseleave",()=>{this.hideTip()})}fill(){let e;this.index&&this.container.setAttribute("data-point-index",this.index),e=this.titleValueFirst?`<strong>${this.titleValue}</strong>${this.titleName}`:`${this.titleName}<strong>${this.titleValue}</strong>`,this.title.innerHTML=e,this.dataPointList.innerHTML="",this.listValues.map((e,s)=>{const i=this.colors[s]||"black";let a=0===e.formatted||e.formatted?e.formatted:e.value,n=t.create("li",{styles:{"border-top":`3px solid ${i}`},innerHTML:`<strong style="display: block;">${0===a||a?a:""}</strong>\n\t\t\t\t\t${e.title?e.title:""}`});this.dataPointList.appendChild(n)})}calcPosition(){let t=this.container.offsetWidth;this.top=this.y-this.container.offsetHeight-P,this.left=this.x-t/2;let e=this.parent.offsetWidth-t,s=this.container.querySelector(".svg-pointer");if(this.left<0)s.style.left=`calc(50% - ${-1*this.left}px)`,this.left=0;else if(this.left>e){let t=`calc(50% + ${this.left-e}px)`;s.style.left=t,this.left=e}else s.style.left="50%"}setValues(t,e,s={},i=[],a=-1){this.titleName=s.name,this.titleValue=s.value,this.listValues=i,this.x=t,this.y=e,this.titleValueFirst=s.valueFirst||0,this.index=a,this.refresh()}hideTip(){this.container.style.top="0px",this.container.style.left="0px",this.container.style.opacity="0"}showTip(){this.container.style.top=this.top+"px",this.container.style.left=this.left+"px",this.container.style.opacity="1"}}function S(t){return parseFloat(t.toFixed(2))}function E(t,e,s,i=!1){s||(s=i?t[0]:t[t.length-1]);let a=new Array(Math.abs(e)).fill(s);return t=i?a.concat(t):t.concat(a)}function O(t,e){return(t+"").length*e}function z(t,e){return{x:Math.sin(t*D)*e,y:Math.cos(t*D)*e}}function W(t,e){let s,i;return t<=e?(s=e-t,i=t):(s=t-e,i=e),[s,i]}function H(t,e,s=e.length-t.length){return s>0?t=E(t,s):e=E(e,s),[t,e]}function F(t,e){if(t)return t.length>e?t.slice(0,e-3)+"...":t}function I(t){let e;if("number"==typeof t)e=t;else if("string"==typeof t&&(e=Number(t),Number.isNaN(e)))return t;let s=Math.floor(Math.log10(Math.abs(e)));if(s<=2)return e;let i=Math.floor(s/3),a=Math.pow(10,s-3*i)*+(e/Math.pow(10,s)).toFixed(1);return Math.round(100*a)/100+" "+["","K","M","B","T"][i]}function R(t,e){let s=[];for(let a=0;a<t.length;a++)s.push([t[a],e[a]]);let i=(t,e,s,i)=>{let a=((t,e)=>{let s=e[0]-t[0],i=e[1]-t[1];return{length:Math.sqrt(Math.pow(s,2)+Math.pow(i,2)),angle:Math.atan2(i,s)}})(e||t,s||t),n=a.angle+(i?Math.PI:0),r=.2*a.length;return[t[0]+Math.cos(n)*r,t[1]+Math.sin(n)*r]};return((t,e)=>t.reduce((t,s,i,a)=>0===i?`${s[0]},${s[1]}`:`${t} ${e(s,i,a)}`,""))(s,(t,e,s)=>{let a=i(s[e-1],s[e-2],t),n=i(t,s[e-1],s[e+1],!0);return`C ${a[0]},${a[1]} ${n[0]},${n[1]} ${t[0]},${t[1]}`})}const Y={"light-blue":"#7cd6fd",blue:"#5e64ff",violet:"#743ee2",red:"#ff5858",orange:"#ffa00a",yellow:"#feef72",green:"#28a745","light-green":"#98d85b",purple:"#b554ff",magenta:"#ffa3ef",black:"#36114C",grey:"#bdd3e6","light-grey":"#f0f4f7","dark-grey":"#b8c2cc"};function V(t){return t>255?255:t<0?0:t}function j(t,e){let s=U(t),i=!1;"#"==s[0]&&(s=s.slice(1),i=!0);let a=parseInt(s,16),n=V((a>>16)+e),r=V((a>>8&255)+e);return(i?"#":"")+(V((255&a)+e)|r<<8|n<<16).toString(16)}function B(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)}const U=t=>Y[t]||t,G=6,q=4,X=15,_=10,J="#dadada",K="#555b51";function Q(t,e){return"string"==typeof t?(e||document).querySelector(t):t||null}function Z(t,e){var s=document.createElementNS("http://www.w3.org/2000/svg",t);for(var i in e){var a=e[i];if("inside"===i)Q(a).appendChild(s);else if("around"===i){var n=Q(a);n.parentNode.insertBefore(s,n),s.appendChild(n)}else"styles"===i?"object"==typeof a&&Object.keys(a).map(t=>{s.style[t]=a[t]}):("className"===i&&(i="class"),"innerHTML"===i?s.textContent=a:s.setAttribute(i,a))}return s}function tt(t,e){return Z("linearGradient",{inside:t,id:e,x1:0,x2:0,y1:0,y2:1})}function et(t,e,s,i){return Z("stop",{inside:t,style:`stop-color: ${s}`,offset:e,"stop-opacity":i})}function st(t,e,s,i){return Z("svg",{className:e,inside:t,width:s,height:i})}function it(t){return Z("defs",{inside:t})}function at(t,e="",s){let i={className:t,transform:e};return s&&(i.inside=s),Z("g",i)}function nt(t,e="",s="none",i="none",a=2){return Z("path",{className:e,d:t,styles:{stroke:s,fill:i,"stroke-width":a}})}function rt(t,e,s,i,a=1,n=0){let[r,o]=[s.x+t.x,s.y+t.y],[l,h]=[s.x+e.x,s.y+e.y];return`M${s.x} ${s.y}\n\t\tL${r} ${o}\n\t\tA ${i} ${i} 0 ${n} ${a?1:0}\n\t\t${l} ${h} z`}function ot(t,e,s,i,a=1,n=0){let[r,o]=[s.x+t.x,s.y+t.y],[l,h,d]=[s.x+e.x,2*s.y,s.y+e.y];return`M${s.x} ${s.y}\n\t\tL${r} ${o}\n\t\tA ${i} ${i} 0 ${n} ${a?1:0}\n\t\t${l} ${h} z\n\t\tL${r} ${h}\n\t\tA ${i} ${i} 0 ${n} ${a?1:0}\n\t\t${l} ${d} z`}function lt(t,e,s,i,a=1,n=0){let[r,o]=[s.x+t.x,s.y+t.y],[l,h]=[s.x+e.x,s.y+e.y];return`M${r} ${o}\n\t\tA ${i} ${i} 0 ${n} ${a?1:0}\n\t\t${l} ${h}`}function ht(t,e,s,i,a=1,n=0){let[r,o]=[s.x+t.x,s.y+t.y],[l,h,d]=[s.x+e.x,2*i+o,s.y+t.y];return`M${r} ${o}\n\t\tA ${i} ${i} 0 ${n} ${a?1:0}\n\t\t${l} ${h}\n\t\tM${r} ${h}\n\t\tA ${i} ${i} 0 ${n} ${a?1:0}\n\t\t${l} ${d}`}function dt(t,e,s=!1){let i="path-fill-gradient-"+e+"-"+(s?"lighter":"default"),a=tt(t,i),n=[1,.6,.2];return s&&(n=[.4,.2,0]),et(a,"0%",e,n[0]),et(a,"50%",e,n[1]),et(a,"100%",e,n[2]),i}function ct(t,e,s,i,a=v,n="none"){return Z("rect",{className:"percentage-bar",x:t,y:e,width:s,height:i,fill:n,styles:{stroke:j(n,-25),"stroke-dasharray":`0, ${i+s}, ${s}, ${i}`,"stroke-width":a}})}function pt(t,e,s,i,a="none",n={}){let r={className:t,x:e,y:s,width:i,height:i,fill:a};return Object.keys(n).map(t=>{r[t]=n[t]}),Z("rect",r)}function ut(t,e,s,i="none",a,n=!1){a=n?F(a,X):a;let r={className:"legend-bar",x:0,y:0,width:s,height:"2px",fill:i},o=Z("text",{className:"legend-dataset-text",x:0,y:0,dy:2*_+"px","font-size":1.2*_+"px","text-anchor":"start",fill:K,innerHTML:a}),l=Z("g",{transform:`translate(${t}, ${e})`});return l.appendChild(Z("rect",r)),l.appendChild(o),l}function mt(t,e,s,i="none",a,n=!1){a=n?F(a,X):a;let r={className:"legend-dot",cx:0,cy:0,r:s,fill:i},o=Z("text",{className:"legend-dataset-text",x:0,y:0,dx:_+"px",dy:_/3+"px","font-size":1.2*_+"px","text-anchor":"start",fill:K,innerHTML:a}),l=Z("g",{transform:`translate(${t}, ${e})`});return l.appendChild(Z("circle",r)),l.appendChild(o),l}function gt(t,e,s,i,a={}){let n=a.fontSize||_;return Z("text",{className:t,x:e,y:s,dy:(void 0!==a.dy?a.dy:n/2)+"px","font-size":n+"px",fill:a.fill||K,"text-anchor":a.textAnchor||"start",innerHTML:i})}function ft(t,e,s,i,a={}){a.stroke||(a.stroke=J);let n=Z("line",{className:"line-vertical "+a.className,x1:0,x2:0,y1:s,y2:i,styles:{stroke:a.stroke}}),r=Z("text",{x:0,y:s>i?s+q:s-q-_,dy:_+"px","font-size":_+"px","text-anchor":"middle",innerHTML:e+""}),o=Z("g",{transform:`translate(${t}, 0)`});return o.appendChild(n),o.appendChild(r),o}function yt(t,e,s,i,a={}){a.stroke||(a.stroke=J),a.lineType||(a.lineType=""),a.shortenNumbers&&(e=I(e));let n=Z("line",{className:"line-horizontal "+a.className+("dashed"===a.lineType?"dashed":""),x1:s,x2:i,y1:0,y2:0,styles:{stroke:a.stroke}}),r=Z("text",{x:s<i?s-q:s+q,y:0,dy:_/2-2+"px","font-size":_+"px","text-anchor":s<i?"end":"start",innerHTML:e+""}),o=Z("g",{transform:`translate(0, ${t})`,"stroke-opacity":1});return 0!==r&&"0"!==r||(o.style.stroke="rgba(27, 31, 35, 0.6)"),o.appendChild(n),o.appendChild(r),o}function xt(t,e,s,i={}){i.pos||(i.pos="left"),i.offset||(i.offset=0),i.mode||(i.mode="span"),i.stroke||(i.stroke=J),i.className||(i.className="");let a=-1*G,n="span"===i.mode?s+G:0;return"tick"===i.mode&&"right"===i.pos&&(a=s+G,n=s),yt(t,e,a+=i.offset,n+=i.offset,{stroke:i.stroke,className:i.className,lineType:i.lineType,shortenNumbers:i.shortenNumbers})}function bt(t,e,s,i={}){i.pos||(i.pos="bottom"),i.offset||(i.offset=0),i.mode||(i.mode="span"),i.stroke||(i.stroke=J),i.className||(i.className="");let a=s+G,n="span"===i.mode?-1*G:s;return"tick"===i.mode&&"top"===i.pos&&(a=-1*G,n=0),ft(t,e,a,n,{stroke:i.stroke,className:i.className,lineType:i.lineType})}function vt(t,e,s,i={}){i.labelPos||(i.labelPos="right");let a=Z("text",{className:"chart-label",x:"left"===i.labelPos?q:s-O(e,5)-q,y:0,dy:_/-2+"px","font-size":_+"px","text-anchor":"start",innerHTML:e+""}),n=yt(t,"",0,s,{stroke:i.stroke||J,className:i.className||"",lineType:i.lineType});return n.appendChild(a),n}function wt(t,e,s,i,a={}){let n=t-e,r=Z("rect",{className:"bar mini",styles:{fill:"rgba(228, 234, 239, 0.49)",stroke:J,"stroke-dasharray":`${s}, ${n}`},x:0,y:0,width:s,height:n});a.labelPos||(a.labelPos="right");let o=Z("text",{className:"chart-label",x:"left"===a.labelPos?q:s-O(i+"",4.5)-q,y:0,dy:_/-2+"px","font-size":_+"px","text-anchor":"start",innerHTML:i+""}),l=Z("g",{transform:`translate(0, ${e})`});return l.appendChild(r),l.appendChild(o),l}function At(t,e,s,i,a="",n=0,r=0,o={}){let[l,h]=W(e,o.zeroLine);h-=r,0===l&&(l=o.minHeight,h-=o.minHeight);let d=Z("rect",{className:"bar mini",style:`fill: ${i}`,"data-point-index":n,x:t,y:h,width:s,height:l});if((a+="")||a.length){d.setAttribute("y",0),d.setAttribute("x",0);let e=Z("text",{className:"data-point-value",x:s/2,y:0,dy:_/2*-1+"px","font-size":_+"px","text-anchor":"middle",innerHTML:a}),i=Z("g",{"data-point-index":n,transform:`translate(${t}, ${h})`});return i.appendChild(d),i.appendChild(e),i}return d}function kt(t,e,s,i,a="",n=0){let r=Z("circle",{style:`fill: ${i}`,"data-point-index":n,cx:t,cy:e,r:s});if((a+="")||a.length){r.setAttribute("cy",0),r.setAttribute("cx",0);let i=Z("text",{className:"data-point-value",x:0,y:0,dy:_/2*-1-s+"px","font-size":_+"px","text-anchor":"middle",innerHTML:a}),o=Z("g",{"data-point-index":n,transform:`translate(${t}, ${e})`});return o.appendChild(r),o.appendChild(i),o}return r}function Lt(t,e,s,i={},a={}){let n=e.map((e,s)=>t[s]+","+e).join("L");i.spline&&(n=R(t,e));let r=nt("M"+n,"line-graph-path",s);if(i.heatline){let t=dt(a.svgDefs,s);r.style.stroke=`url(#${t})`}let o={path:r};if(i.regionFill){let e=dt(a.svgDefs,s,!0),i="M"+`${t[0]},${a.zeroLine}L`+n+`L${t.slice(-1)[0]},${a.zeroLine}`;o.region=nt(i,"region-fill","none",`url(#${e})`)}return o}let Pt={bar:t=>{let e;"rect"!==t.nodeName&&(e=t.getAttribute("transform"),t=t.childNodes[0]);let s=t.cloneNode();return s.style.fill="#000000",s.style.opacity="0.4",e&&s.setAttribute("transform",e),s},dot:t=>{let e;"circle"!==t.nodeName&&(e=t.getAttribute("transform"),t=t.childNodes[0]);let s=t.cloneNode(),i=t.getAttribute("r"),a=t.getAttribute("fill");return s.setAttribute("r",parseInt(i)+4),s.setAttribute("fill",a),s.style.opacity="0.6",e&&s.setAttribute("transform",e),s},heat_square:t=>{let e;"circle"!==t.nodeName&&(e=t.getAttribute("transform"),t=t.childNodes[0]);let s=t.cloneNode(),i=t.getAttribute("r"),a=t.getAttribute("fill");return s.setAttribute("r",parseInt(i)+4),s.setAttribute("fill",a),s.style.opacity="0.6",e&&s.setAttribute("transform",e),s}},Tt={bar:(t,e)=>{let s;"rect"!==t.nodeName&&(s=t.getAttribute("transform"),t=t.childNodes[0]);let i=["x","y","width","height"];Object.values(t.attributes).filter(t=>i.includes(t.name)&&t.specified).map(t=>{e.setAttribute(t.name,t.nodeValue)}),s&&e.setAttribute("transform",s)},dot:(t,e)=>{let s;"circle"!==t.nodeName&&(s=t.getAttribute("transform"),t=t.childNodes[0]);let i=["cx","cy"];Object.values(t.attributes).filter(t=>i.includes(t.name)&&t.specified).map(t=>{e.setAttribute(t.name,t.nodeValue)}),s&&e.setAttribute("transform",s)},heat_square:(t,e)=>{let s;"circle"!==t.nodeName&&(s=t.getAttribute("transform"),t=t.childNodes[0]);let i=["cx","cy"];Object.values(t.attributes).filter(t=>i.includes(t.name)&&t.specified).map(t=>{e.setAttribute(t.name,t.nodeValue)}),s&&e.setAttribute("transform",s)}};const Mt=350,Ct=350,Dt=Mt,$t=250,Nt="easein";function St(t,e,s,i){let a="string"==typeof e?e:e.join(", ");return[t,{transform:s.join(", ")},i,Nt,"translate",{transform:a}]}function Et(t,e,s){return St(t,[s,0],[e,0],Dt)}function Ot(t,e,s){return St(t,[0,s],[0,e],Dt)}function zt(t,e,s,i){let a=e-s,n=t.childNodes[0],r=n.getAttribute("width");return[[n,{height:a,"stroke-dasharray":`${r}, ${a}`},Dt,Nt],St(t,[0,i],[0,s],Dt)]}function Wt(t,e,s,i,a=0,n={}){let[r,o]=W(s,n.zeroLine);if(o-=a,"rect"!==t.nodeName){let s=[t.childNodes[0],{width:i,height:r},Mt,Nt],a=t.getAttribute("transform").split("(")[1].slice(0,-1);return[s,St(t,a,[e,o],Dt)]}return[[t,{width:i,height:r,x:e,y:o},Mt,Nt]]}function Ht(t,e,s){if("circle"!==t.nodeName){let i=t.getAttribute("transform").split("(")[1].slice(0,-1);return[St(t,i,[e,s],Dt)]}return[[t,{cx:e,cy:s},Mt,Nt]]}function Ft(t,e,s,i,a){let n=[],r=s.map((t,s)=>e[s]+","+t).join("L");a&&(r=R(e,s));const o=[t.path,{d:"M"+r},Ct,Nt];if(n.push(o),t.region){let s=`${e[0]},${i}L`,a=`L${e.slice(-1)[0]}, ${i}`;const o=[t.region,{d:"M"+s+r+a},Ct,Nt];n.push(o)}return n}function It(t,e){return[t,{d:e},Mt,Nt]}const Rt={ease:"0.25 0.1 0.25 1",linear:"0 0 1 1",easein:"0.1 0.8 0.2 1",easeout:"0 0 0.58 1",easeinout:"0.42 0 0.58 1"};function Yt(t,e,s,i="linear",a,n={}){let r=t.cloneNode(!0),o=t.cloneNode(!0);for(var l in e){let d;d="transform"===l?document.createElementNS("http://www.w3.org/2000/svg","animateTransform"):document.createElementNS("http://www.w3.org/2000/svg","animate");let c=n[l]||t.getAttribute(l),p=e[l],u={attributeName:l,from:c,to:p,begin:"0s",dur:s/1e3+"s",values:c+";"+p,keySplines:Rt[i],keyTimes:"0;1",calcMode:"spline",fill:"freeze"};for(var h in a&&(u.type=a),u)d.setAttribute(h,u[h]);r.appendChild(d),a?o.setAttribute(l,`translate(${p})`):o.setAttribute(l,p)}return[r,o]}function Vt(t,e){t.style.transform=e,t.style.webkitTransform=e,t.style.msTransform=e,t.style.mozTransform=e,t.style.oTransform=e}function jt(t,e){let s=[],i=[];e.map(t=>{let e,a,n=t[0],r=n.parentNode;t[0]=n,[e,a]=Yt(...t),s.push(a),i.push([e,r]),r.replaceChild(e,n)});let a=t.cloneNode(!0);return i.map((t,i)=>{t[1].replaceChild(s[i],t[0]),e[i][0]=s[i]}),a}function Bt(t,e,s){if(0===s.length)return;let i=jt(e,s);e.parentNode==t&&(t.removeChild(e),t.appendChild(i)),setTimeout(()=>{i.parentNode==t&&(t.removeChild(i),t.appendChild(e))},$t)}const Ut=".chart-container{position:relative;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Roboto','Oxygen','Ubuntu','Cantarell','Fira Sans','Droid Sans','Helvetica Neue',sans-serif}.chart-container .axis,.chart-container .chart-label{fill:#555b51}.chart-container .axis line,.chart-container .chart-label line{stroke:#dadada}.chart-container .dataset-units circle{stroke:#fff;stroke-width:2}.chart-container .dataset-units path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container .dataset-path{stroke-width:2px}.chart-container .path-group path{fill:none;stroke-opacity:1;stroke-width:2px}.chart-container line.dashed{stroke-dasharray:5,3}.chart-container .axis-line .specific-value{text-anchor:start}.chart-container .axis-line .y-line{text-anchor:end}.chart-container .axis-line .x-line{text-anchor:middle}.chart-container .legend-dataset-text{fill:#6c7680;font-weight:600}.graph-svg-tip{position:absolute;z-index:99999;padding:10px;font-size:12px;color:#959da5;text-align:center;background:rgba(0,0,0,.8);border-radius:3px}.graph-svg-tip ul{padding-left:0;display:flex}.graph-svg-tip ol{padding-left:0;display:flex}.graph-svg-tip ul.data-point-list li{min-width:90px;flex:1;font-weight:600}.graph-svg-tip strong{color:#dfe2e5;font-weight:600}.graph-svg-tip .svg-pointer{position:absolute;height:5px;margin:0 0 0 -5px;content:' ';border:5px solid transparent;border-top-color:rgba(0,0,0,.8)}.graph-svg-tip.comparison{padding:0;text-align:left;pointer-events:none}.graph-svg-tip.comparison .title{display:block;padding:10px;margin:0;font-weight:600;line-height:1;pointer-events:none}.graph-svg-tip.comparison ul{margin:0;white-space:nowrap;list-style:none}.graph-svg-tip.comparison li{display:inline-block;padding:5px 10px}";function Gt(t,e){var s=document.createElement("a");s.style="display: none";var i=new Blob(e,{type:"image/svg+xml; charset=utf-8"}),a=window.URL.createObjectURL(i);s.href=a,s.download=t,document.body.appendChild(s),s.click(),setTimeout(function(){document.body.removeChild(s),window.URL.revokeObjectURL(a)},300)}function qt(e){let s=e.cloneNode(!0);s.classList.add("chart-container"),s.setAttribute("xmlns","http://www.w3.org/2000/svg"),s.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");let i=t.create("style",{innerHTML:Ut});s.insertBefore(i,s.firstChild);let a=t.create("div");return a.appendChild(s),a.innerHTML}class Xt{constructor(t,e){if(this.parent="string"==typeof t?document.querySelector(t):t,!(this.parent instanceof HTMLElement))throw new Error("No `parent` element to render on was provided.");this.rawChartArgs=e,this.title=e.title||"",this.type=e.type||"",this.realData=this.prepareData(e.data),this.data=this.prepareFirstData(this.realData),this.colors=this.validateColors(e.colors,this.type),this.config={showTooltip:1,showLegend:1,isNavigable:e.isNavigable||0,animate:void 0!==e.animate?e.animate:1,truncateLegends:e.truncateLegends||0},this.measures=JSON.parse(JSON.stringify(n));let s=this.measures;this.setMeasures(e),this.title.length||(s.titleHeight=0),this.config.showLegend||(s.legendHeight=0),this.argHeight=e.height||s.baseHeight,this.state={},this.options={},this.initTimeout=d,this.config.isNavigable&&(this.overlays=[]),this.configure(e)}prepareData(t){return t}prepareFirstData(t){return t}validateColors(t,e){const s=[];return(t=(t||[]).concat(C[e])).forEach(t=>{const e=U(t);B(e)?s.push(e):console.warn('"'+t+'" is not a valid color.')}),s}setMeasures(){}configure(){let t=this.argHeight;this.baseHeight=t,this.height=t-l(this.measures),this.boundDrawFn=(()=>this.draw(!0)),window.addEventListener("resize",this.boundDrawFn),window.addEventListener("orientationchange",this.boundDrawFn)}destroy(){window.removeEventListener("resize",this.boundDrawFn),window.removeEventListener("orientationchange",this.boundDrawFn)}setup(){this.makeContainer(),this.updateWidth(),this.makeTooltip(),this.draw(!1,!0)}makeContainer(){this.parent.innerHTML="";let e={inside:this.parent,className:"chart-container"};this.independentWidth&&(e.styles={width:this.independentWidth+"px"}),this.container=t.create("div",e)}makeTooltip(){this.tip=new N({parent:this.container,colors:this.colors}),this.bindTooltip()}bindTooltip(){}draw(t=!1,e=!1){this.updateWidth(),this.calc(t),this.makeChartArea(),this.setupComponents(),this.components.forEach(t=>t.setup(this.drawArea)),this.render(this.components,!1),e&&(this.data=this.realData,setTimeout(()=>{this.update(this.data)},this.initTimeout)),this.renderLegend(),this.setupNavigation(e)}calc(){}updateWidth(){this.baseWidth=i(this.parent),this.width=this.baseWidth-h(this.measures)}makeChartArea(){this.svg&&this.container.removeChild(this.svg);let t=this.measures;this.svg=st(this.container,"frappe-chart chart",this.baseWidth,this.baseHeight),this.svgDefs=it(this.svg),this.title.length&&(this.titleEL=gt("title",t.margins.left,t.margins.top,this.title,{fontSize:t.titleFontSize,fill:"#666666",dy:t.titleFontSize}));let e=r(t);this.drawArea=at(this.type+"-chart chart-draw-area",`translate(${o(t)}, ${e})`),this.config.showLegend&&(e+=this.height+t.paddings.bottom,this.legendArea=at("chart-legend",`translate(${o(t)}, ${e})`)),this.title.length&&this.svg.appendChild(this.titleEL),this.svg.appendChild(this.drawArea),this.config.showLegend&&this.svg.appendChild(this.legendArea),this.updateTipOffset(o(t),r(t))}updateTipOffset(t,e){this.tip.offset={x:t,y:e}}setupComponents(){this.components=new Map}update(t){t||console.error("No data to update."),this.data=this.prepareData(t),this.calc(),this.render(this.components,this.config.animate)}render(t=this.components,e=!0){this.config.isNavigable&&this.overlays.map(t=>t.parentNode.removeChild(t));let s=[];t.forEach(t=>{s=s.concat(t.update(e))}),s.length>0?(Bt(this.container,this.svg,s),setTimeout(()=>{t.forEach(t=>t.make()),this.updateNav()},c)):(t.forEach(t=>t.make()),this.updateNav())}updateNav(){this.config.isNavigable&&(this.makeOverlay(),this.bindUnits())}renderLegend(){}setupNavigation(t=!1){this.config.isNavigable&&t&&(this.bindOverlay(),this.keyActions={13:this.onEnterKey.bind(this),37:this.onLeftArrow.bind(this),38:this.onUpArrow.bind(this),39:this.onRightArrow.bind(this),40:this.onDownArrow.bind(this)},document.addEventListener("keydown",t=>{s(this.container)&&(t=t||window.event,this.keyActions[t.keyCode]&&this.keyActions[t.keyCode]())}))}makeOverlay(){}updateOverlay(){}bindOverlay(){}bindUnits(){}onLeftArrow(){}onRightArrow(){}onUpArrow(){}onDownArrow(){}onEnterKey(){}addDataPoint(){}removeDataPoint(){}getDataPoint(){}setCurrentDataPoint(){}updateDataset(){}export(){let t=qt(this.svg);Gt(this.title||"Chart",[t])}}class _t extends Xt{constructor(t,e){super(t,e)}configure(t){super.configure(t),this.config.maxSlices=t.maxSlices||20,this.config.maxLegendPoints=t.maxLegendPoints||20}calc(){let t=this.state,e=this.config.maxSlices;t.sliceTotals=[];let s=this.data.labels.map((t,e)=>{let s=0;return this.data.datasets.map(t=>{s+=t.values[e]}),[s,t]}).filter(t=>t[0]>=0),i=s;if(s.length>e){s.sort((t,e)=>e[0]-t[0]),i=s.slice(0,e-1);let t=s.slice(e-1),a=0;t.map(t=>{a+=t[0]}),i.push([a,"Rest"]),this.colors[e-1]="grey"}t.labels=[],i.map(e=>{t.sliceTotals.push(e[0]),t.labels.push(e[1])}),t.grandTotal=t.sliceTotals.reduce((t,e)=>t+e,0),this.center={x:this.width/2,y:this.height/2}}renderLegend(){let t=this.state;this.legendArea.textContent="",this.legendTotals=t.sliceTotals.slice(0,this.config.maxLegendPoints);let e=0,s=0;this.legendTotals.map((i,a)=>{let n=110,r=Math.floor((this.width-h(this.measures))/n);this.legendTotals.length<r&&(n=this.width/this.legendTotals.length),e>r&&(e=0,s+=20);let o=mt(n*e+5,s,5,this.colors[a],`${t.labels[a]}: ${i}`,this.config.truncateLegends);this.legendArea.appendChild(o),e++})}}const Jt=12,Kt=7,Qt=1e3,Zt=86400,te=["January","February","March","April","May","June","July","August","September","October","November","December"],ee=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function se(t){let e=new Date(t);return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e}function ie(t){let e=t.getDate(),s=t.getMonth()+1;return[t.getFullYear(),(s>9?"":"0")+s,(e>9?"":"0")+e].join("-")}function ae(t){return new Date(t.getTime())}function ne(t,e){let s=de(t);return Math.ceil(re(s,e)/Kt)}function re(t,e){let s=Zt*Qt;return(se(e)-se(t))/s}function oe(t,e){return t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}function le(t,e=!1){let s=te[t];return e?s.slice(0,3):s}function he(t,e){return new Date(e,t+1,0)}function de(t){let e=ae(t);const s=e.getDay();return 0!==s&&ce(e,-1*s),e}function ce(t,e){t.setDate(t.getDate()+e)}class pe{constructor({layerClass:t="",layerTransform:e="",constants:s,getData:i,makeElements:a,animateElements:n}){this.layerTransform=e,this.constants=s,this.makeElements=a,this.getData=i,this.animateElements=n,this.store=[],this.labels=[],this.layerClass=t,this.layerClass="function"==typeof this.layerClass?this.layerClass():this.layerClass,this.refresh()}refresh(t){this.data=t||this.getData()}setup(t){this.layer=at(this.layerClass,this.layerTransform,t)}make(){this.render(this.data),this.oldData=this.data}render(t){this.store=this.makeElements(t),this.layer.textContent="",this.store.forEach(t=>{this.layer.appendChild(t)}),this.labels.forEach(t=>{this.layer.appendChild(t)})}update(t=!0){this.refresh();let e=[];return t&&(e=this.animateElements(this.data)||[]),e}}let ue={donutSlices:{layerClass:"donut-slices",makeElements:t=>t.sliceStrings.map((e,s)=>{let i=nt(e,"donut-path",t.colors[s],"none",t.strokeWidth);return i.style.transition="transform .3s;",i}),animateElements(t){return this.store.map((e,s)=>It(e,t.sliceStrings[s]))}},pieSlices:{layerClass:"pie-slices",makeElements:t=>t.sliceStrings.map((e,s)=>{let i=nt(e,"pie-path","none",t.colors[s]);return i.style.transition="transform .3s;",i}),animateElements(t){return this.store.map((e,s)=>It(e,t.sliceStrings[s]))}},percentageBars:{layerClass:"percentage-bars",makeElements(t){return t.xPositions.map((e,s)=>{return ct(e,0,t.widths[s],this.constants.barHeight,this.constants.barDepth,t.colors[s])})},animateElements(t){if(t)return[]}},yAxis:{layerClass:"y axis",makeElements(t){return t.positions.map((e,s)=>xt(e,t.labels[s],this.constants.width,{mode:this.constants.mode,pos:this.constants.pos,shortenNumbers:this.constants.shortenNumbers}))},animateElements(t){let e=t.positions,s=t.labels,i=this.oldData.positions,a=this.oldData.labels;return[i,e]=H(i,e),[a,s]=H(a,s),this.render({positions:i,labels:s}),this.store.map((t,s)=>Ot(t,e[s],i[s]))}},xAxis:{layerClass:"x axis",makeElements(t){return t.positions.map((e,s)=>bt(e,t.calcLabels[s],this.constants.height,{mode:this.constants.mode,pos:this.constants.pos}))},animateElements(t){let e=t.positions,s=t.calcLabels,i=this.oldData.positions,a=this.oldData.calcLabels;return[i,e]=H(i,e),[a,s]=H(a,s),this.render({positions:i,calcLabels:s}),this.store.map((t,s)=>Et(t,e[s],i[s]))}},yMarkers:{layerClass:"y-markers",makeElements(t){return t.map(t=>vt(t.position,t.label,this.constants.width,{labelPos:t.options.labelPos,mode:"span",lineType:"dashed"}))},animateElements(t){[this.oldData,t]=H(this.oldData,t);let e=t.map(t=>t.position),s=t.map(t=>t.label),i=t.map(t=>t.options),a=this.oldData.map(t=>t.position);return this.render(a.map((t,e)=>({position:a[e],label:s[e],options:i[e]}))),this.store.map((t,s)=>Ot(t,e[s],a[s]))}},yRegions:{layerClass:"y-regions",makeElements(t){return t.map(t=>wt(t.startPos,t.endPos,this.constants.width,t.label,{labelPos:t.options.labelPos}))},animateElements(t){[this.oldData,t]=H(this.oldData,t);let e=t.map(t=>t.endPos),s=t.map(t=>t.label),i=t.map(t=>t.startPos),a=t.map(t=>t.options),n=this.oldData.map(t=>t.endPos),r=this.oldData.map(t=>t.startPos);this.render(n.map((t,e)=>({startPos:r[e],endPos:n[e],label:s[e],options:a[e]})));let o=[];return this.store.map((t,s)=>{o=o.concat(zt(t,i[s],e[s],n[s]))}),o}},heatDomain:{layerClass:function(){return"heat-domain domain-"+this.constants.index},makeElements(t){let{index:e,colWidth:s,rowHeight:i,squareSize:a,xTranslate:n}=this.constants,r=n,o=0;return this.serializedSubDomains=[],t.cols.map((t,n)=>{1===n&&this.labels.push(gt("domain-name",r,-12,le(e,!0).toUpperCase(),{fontSize:9})),t.map((t,e)=>{if(t.fill){let s={"data-date":t.yyyyMmDd,"data-value":t.dataValue,"data-day":e},i=pt("day",r,o,a,t.fill,s);this.serializedSubDomains.push(i)}o+=i}),o=0,r+=s}),this.serializedSubDomains},animateElements(t){if(t)return[]}},barGraph:{layerClass:function(){return"dataset-units dataset-bars dataset-"+this.constants.index},makeElements(t){let e=this.constants;return this.unitType="bar",this.units=t.yPositions.map((s,i)=>At(t.xPositions[i],s,t.barWidth,e.color,t.labels[i],i,t.offsets[i],{zeroLine:t.zeroLine,barsWidth:t.barsWidth,minHeight:e.minHeight})),this.units},animateElements(t){let e=t.xPositions,s=t.yPositions,i=t.offsets,a=t.labels,n=this.oldData.xPositions,r=this.oldData.yPositions,o=this.oldData.offsets,l=this.oldData.labels;[n,e]=H(n,e),[r,s]=H(r,s),[o,i]=H(o,i),[l,a]=H(l,a),this.render({xPositions:n,yPositions:r,offsets:o,labels:a,zeroLine:this.oldData.zeroLine,barsWidth:this.oldData.barsWidth,barWidth:this.oldData.barWidth});let h=[];return this.store.map((a,n)=>{h=h.concat(Wt(a,e[n],s[n],t.barWidth,i[n],{zeroLine:t.zeroLine}))}),h}},lineGraph:{layerClass:function(){return"dataset-units dataset-line dataset-"+this.constants.index},makeElements(t){let e=this.constants;return this.unitType="dot",this.paths={},e.hideLine||(this.paths=Lt(t.xPositions,t.yPositions,e.color,{heatline:e.heatline,regionFill:e.regionFill,spline:e.spline},{svgDefs:e.svgDefs,zeroLine:t.zeroLine})),this.units=[],e.hideDots||(this.units=t.yPositions.map((s,i)=>kt(t.xPositions[i],s,t.radius,e.color,e.valuesOverPoints?t.values[i]:"",i))),Object.values(this.paths).concat(this.units)},animateElements(t){let e=t.xPositions,s=t.yPositions,i=t.values,a=this.oldData.xPositions,n=this.oldData.yPositions,r=this.oldData.values;[a,e]=H(a,e),[n,s]=H(n,s),[r,i]=H(r,i),this.render({xPositions:a,yPositions:n,values:i,zeroLine:this.oldData.zeroLine,radius:this.oldData.radius});let o=[];return Object.keys(this.paths).length&&(o=o.concat(Ft(this.paths,e,s,t.zeroLine,this.constants.spline))),this.units.length&&this.units.map((t,i)=>{o=o.concat(Ht(t,e[i],s[i]))}),o}}};function me(t,e,s){let i=Object.keys(ue).filter(e=>t.includes(e)),a=ue[i[0]];return Object.assign(a,{constants:e,getData:s}),new pe(a)}class ge extends _t{constructor(t,e){super(t,e),this.type="percentage",this.setup()}setMeasures(t){let e=this.measures;this.barOptions=t.barOptions||{};let s=this.barOptions;s.height=s.height||b,s.depth=s.depth||v,e.paddings.right=30,e.legendHeight=60,e.baseHeight=8*(s.height+.5*s.depth)}setupComponents(){let t=this.state,e=[["percentageBars",{barHeight:this.barOptions.height,barDepth:this.barOptions.depth},function(){return{xPositions:t.xPositions,widths:t.widths,colors:this.colors}}.bind(this)]];this.components=new Map(e.map(t=>{let e=me(...t);return[t[0],e]}))}calc(){super.calc();let t=this.state;t.xPositions=[],t.widths=[];let e=0;t.sliceTotals.map(s=>{let i=this.width*s/t.grandTotal;t.widths.push(i),t.xPositions.push(e),e+=i})}makeDataByIndex(){}bindTooltip(){let t=this.state;this.container.addEventListener("mousemove",s=>{let i=this.components.get("percentageBars").store,a=s.target;if(i.includes(a)){let s=i.indexOf(a),n=e(this.container),r=e(a),o=r.left-n.left+parseInt(a.getAttribute("width"))/2,l=r.top-n.top,h=(this.formattedLabels&&this.formattedLabels.length>0?this.formattedLabels[s]:this.state.labels[s])+": ",d=t.sliceTotals[s]/t.grandTotal;this.tip.setValues(o,l,{name:h,value:(100*d).toFixed(1)+"%"}),this.tip.showTip()}})}}exports.PercentageChart=ge;class fe extends _t{constructor(t,e){super(t,e),this.type="pie",this.initTimeout=0,this.init=1,this.setup()}configure(t){super.configure(t),this.mouseMove=this.mouseMove.bind(this),this.mouseLeave=this.mouseLeave.bind(this),this.hoverRadio=t.hoverRadio||.1,this.config.startAngle=t.startAngle||0,this.clockWise=t.clockWise||!1}calc(){super.calc();let t=this.state;this.radius=this.height>this.width?this.center.x:this.center.y;const{radius:e,clockWise:s}=this,i=t.slicesProperties||[];t.sliceStrings=[],t.slicesProperties=[];let a=180-this.config.startAngle;t.sliceTotals.map((n,r)=>{const o=a,l=n/t.grandTotal*$,h=l>180?1:0,d=s?-l:l,c=a+=d,p=z(o,e),u=z(c,e),m=this.init&&i[r];let g,f;this.init?(g=m?m.startPosition:p,f=m?m.endPosition:p):(g=p,f=u);const y=360===l?ot(g,f,this.center,this.radius,s,h):rt(g,f,this.center,this.radius,s,h);t.sliceStrings.push(y),t.slicesProperties.push({startPosition:p,endPosition:u,value:n,total:t.grandTotal,startAngle:o,endAngle:c,angle:d})}),this.init=0}setupComponents(){let t=this.state,e=[["pieSlices",{},function(){return{sliceStrings:t.sliceStrings,colors:this.colors}}.bind(this)]];this.components=new Map(e.map(t=>{let e=me(...t);return[t[0],e]}))}calTranslateByAngle(t){const{radius:e,hoverRadio:s}=this,i=z(t.startAngle+t.angle/2,e);return`translate3d(${i.x*s}px,${i.y*s}px,0)`}hoverSlice(t,s,i,a){if(!t)return;const n=this.colors[s];if(i){Vt(t,this.calTranslateByAngle(this.state.slicesProperties[s])),t.style.fill=j(n,50);let i=e(this.svg),r=a.pageX-i.left+10,o=a.pageY-i.top-10,l=(this.formatted_labels&&this.formatted_labels.length>0?this.formatted_labels[s]:this.state.labels[s])+": ",h=(100*this.state.sliceTotals[s]/this.state.grandTotal).toFixed(1);this.tip.setValues(r,o,{name:l,value:h+"%"}),this.tip.showTip()}else Vt(t,"translate3d(0,0,0)"),this.tip.hideTip(),t.style.fill=n}bindTooltip(){this.container.addEventListener("mousemove",this.mouseMove),this.container.addEventListener("mouseleave",this.mouseLeave)}mouseMove(t){const e=t.target;let s=this.components.get("pieSlices").store,i=this.curActiveSliceIndex,a=this.curActiveSlice;if(s.includes(e)){let n=s.indexOf(e);this.hoverSlice(a,i,!1),this.curActiveSlice=e,this.curActiveSliceIndex=n,this.hoverSlice(e,n,!0,t)}else this.mouseLeave()}mouseLeave(){this.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,!1)}}function ye(t){if(0===t)return[0,0];if(isNaN(t))return{mantissa:-6755399441055744,exponent:972};var e=t>0?1:-1;if(!isFinite(t))return{mantissa:4503599627370496*e,exponent:972};t=Math.abs(t);var s=Math.floor(Math.log10(t));return[e*(t/Math.pow(10,s)),s]}function xe(t,e=0){let s=Math.ceil(t),i=Math.floor(e),a=s-i,n=a,r=1;a>5&&(a%2!=0&&(a=++s-i),n=a/2,r=2),a<=2&&(r=a/(n=4)),0===a&&(n=5,r=1);let o=[];for(var l=0;l<=n;l++)o.push(i+r*l);return o}function be(t,e=0){let[s,i]=ye(t),a=e?e/Math.pow(10,i):0,n=xe(s=s.toFixed(6),a);return n=n.map(t=>t*Math.pow(10,i))}function ve(t,e=!1){let s=Math.max(...t),i=Math.min(...t),a=0,n=[];function r(t,e){let s=be(t),i=s[1]-s[0],a=0;for(var n=1;a<e;n++)a+=i,s.unshift(-1*a);return s}if(s>=0&&i>=0)a=ye(s)[1],n=e?be(s,i):be(s);else if(s>0&&i<0){let t=Math.abs(i);if(s>=t)a=ye(s)[1],n=r(s,t);else{a=ye(t)[1],n=r(t,s).map(t=>-1*t)}}else if(s<=0&&i<=0){let t=Math.abs(i),r=Math.abs(s);a=ye(t)[1],n=(n=e?be(t,r):be(t)).reverse().map(t=>-1*t)}return n}function we(t){let e,s=Ae(t);if(t.indexOf(0)>=0)e=t.indexOf(0);else if(t[0]>0){e=-1*t[0]/s}else{e=-1*t[t.length-1]/s+(t.length-1)}return e}function Ae(t){return t[1]-t[0]}function ke(t){return t[t.length-1]-t[0]}function Le(t,e){return S(e.zeroLine-t*e.scaleMultiplier)}function Pe(t,e,s=!1){let i=e.reduce(function(e,s){return Math.abs(s-t)<Math.abs(e-t)?s:e},[]);return s?e.indexOf(i):i}function Te(t,e){let s=Math.max(...t),i=1/(e-1),a=[];for(var n=0;n<e;n++){let t=s*(i*n);a.push(t)}return a}function Me(t,e){return e.filter(e=>e<t).length}exports.PieChart=fe;const Ce=A+2,De=Ce;class $e extends Xt{constructor(t,e){super(t,e),this.type="heatmap",this.countLabel=e.countLabel||"";let s=["Sunday","Monday"],i=s.includes(e.startSubDomain)?e.startSubDomain:"Sunday";this.startSubDomainIndex=s.indexOf(i),this.setup()}setMeasures(t){let e=this.measures;this.discreteDomains=0===t.discreteDomains?0:1,e.paddings.top=3*De,e.paddings.bottom=0,e.legendHeight=2*De,e.baseHeight=De*Kt+l(e);let s=this.data,i=this.discreteDomains?Jt:0;this.independentWidth=(ne(s.start,s.end)+i)*Ce+h(e)}updateWidth(){let t=this.discreteDomains?Jt:0,e=this.state.noOfWeeks?this.state.noOfWeeks:52;this.baseWidth=(e+t)*Ce+h(this.measures)}prepareData(t=this.data){if(t.start&&t.end&&t.start>t.end)throw new Error("Start date cannot be greater than end date.");if(t.start||(t.start=new Date,t.start.setFullYear(t.start.getFullYear()-1)),t.end||(t.end=new Date),t.dataPoints=t.dataPoints||{},parseInt(Object.keys(t.dataPoints)[0])>1e5){let e={};Object.keys(t.dataPoints).forEach(s=>{let i=new Date(s*Qt);e[ie(i)]=t.dataPoints[s]}),t.dataPoints=e}return t}calc(){let t=this.state;t.start=ae(this.data.start),t.end=ae(this.data.end),t.firstWeekStart=ae(t.start),t.noOfWeeks=ne(t.start,t.end),t.distribution=Te(Object.values(this.data.dataPoints),w),t.domainConfigs=this.getDomains()}setupComponents(){let t=this.state,e=this.discreteDomains?0:1,s=t.domainConfigs.map((s,i)=>["heatDomain",{index:s.index,colWidth:Ce,rowHeight:De,squareSize:A,xTranslate:t.domainConfigs.filter((t,e)=>e<i).map(t=>t.cols.length-e).reduce((t,e)=>t+e,0)*Ce},function(){return t.domainConfigs[i]}.bind(this)]);this.components=new Map(s.map((t,e)=>{let s=me(...t);return[t[0]+"-"+e,s]}));let i=0;ee.forEach((t,e)=>{if([1,3,5].includes(e)){let e=gt("subdomain-name",-Ce/2,i,t,{fontSize:A,dy:8,textAnchor:"end"});this.drawArea.appendChild(e)}i+=De})}update(t){t||console.error("No data to update."),this.data=this.prepareData(t),this.draw(),this.bindTooltip()}bindTooltip(){this.container.addEventListener("mousemove",t=>{this.components.forEach(e=>{let s=e.store,i=t.target;if(s.includes(i)){let e=i.getAttribute("data-value"),s=i.getAttribute("data-date").split("-"),a=le(parseInt(s[1])-1,!0),n=this.container.getBoundingClientRect(),r=i.getBoundingClientRect(),o=parseInt(t.target.getAttribute("width")),l=r.left-n.left+o/2,h=r.top-n.top,d=e+" "+this.countLabel,c=" on "+a+" "+s[0]+", "+s[2];this.tip.setValues(l,h,{name:c,value:d,valueFirst:1},[]),this.tip.showTip()}})})}renderLegend(){this.legendArea.textContent="";let t=0,e=De,s=gt("subdomain-name",t,e,"Less",{fontSize:A+1,dy:9});t=2*Ce+Ce/2,this.legendArea.appendChild(s),this.colors.slice(0,w).map((s,i)=>{const a=pt("heatmap-legend-unit",t+(Ce+3)*i,e,A,s);this.legendArea.appendChild(a)});let i=gt("subdomain-name",t+w*(Ce+3)+Ce/4,e,"More",{fontSize:A+1,dy:9});this.legendArea.appendChild(i)}getDomains(){let t=this.state;const[e,s]=[t.start.getMonth(),t.start.getFullYear()],[i,a]=[t.end.getMonth(),t.end.getFullYear()],n=i-e+1+12*(a-s);let r=[],o=ae(t.start);for(var l=0;l<n;l++){let e=t.end;if(!oe(o,t.end)){let[t,s]=[o.getMonth(),o.getFullYear()];e=he(t,s)}r.push(this.getDomainConfig(o,e)),ce(e,1),o=e}return r}getDomainConfig(t,e=""){let[s,i]=[t.getMonth(),t.getFullYear()],a=de(t),n={index:s,cols:[]};ce(e=ae(e)||he(s,i),1);let r,o=ne(a,e),l=[];for(var h=0;h<o;h++)r=this.getCol(a,s),l.push(r),ce(a=new Date(r[Kt-1].yyyyMmDd),1);return void 0!==r[Kt-1].dataValue&&(ce(a,1),l.push(this.getCol(a,s,!0))),n.cols=l,n}getCol(t,e,s=!1){let i=this.state,a=ae(t),n=[];for(var r=0;r<Kt;r++,ce(a,1)){let t={},r=a>=i.start&&a<=i.end;s||a.getMonth()!==e||!r?t.yyyyMmDd=ie(a):t=this.getSubDomainConfig(a),n.push(t)}return n}getSubDomainConfig(t){let e=ie(t),s=this.data.dataPoints[e];return{yyyyMmDd:e,dataValue:s||0,fill:this.colors[Me(s,this.state.distribution)]}}}function Ne(t,e){t.labels=t.labels||[];let s=t.labels.length,i=t.datasets,a=new Array(s).fill(0);return i||(i=[{values:a}]),i.map(t=>{if(t.values){let e=t.values;e=(e=e.map(t=>isNaN(t)?0:t)).length>s?e.slice(0,s):E(e,s-e.length,0)}else t.values=a;t.chartType||(u.includes(e),t.chartType=e)}),t.yRegions&&t.yRegions.map(t=>{t.end<t.start&&([t.start,t.end]=[t.end,t.start])}),t}function Se(t){let e=t.labels.length,s=new Array(e).fill(0),i={labels:t.labels.slice(0,-1),datasets:t.datasets.map(t=>({name:"",values:s.slice(0,-1),chartType:t.chartType}))};return t.yMarkers&&(i.yMarkers=[{value:0,label:""}]),t.yRegions&&(i.yRegions=[{start:0,end:0,label:""}]),i}function Ee(t,e=[],s=!0){let i=t/e.length;i<=0&&(i=1);let a=i/L;return e.map((t,e)=>{if((t+="").length>a)if(s){e%Math.ceil(t.length/a)!=0&&(t="")}else t=a-3>0?t.slice(0,a-3)+" ...":t.slice(0,a)+"..";return t})}exports.Heatmap=$e;class Oe extends Xt{constructor(t,e){super(t,e),this.barOptions=e.barOptions||{},this.lineOptions=e.lineOptions||{},this.type=e.type||"line",this.init=1,this.setup()}setMeasures(){this.data.datasets.length<=1&&(this.config.showLegend=0,this.measures.paddings.bottom=30)}configure(t){super.configure(t),t.axisOptions=t.axisOptions||{},t.tooltipOptions=t.tooltipOptions||{},this.config.xAxisMode=t.axisOptions.xAxisMode||"span",this.config.yAxisMode=t.axisOptions.yAxisMode||"span",this.config.xIsSeries=t.axisOptions.xIsSeries||0,this.config.shortenYAxisNumbers=t.axisOptions.shortenYAxisNumbers||0,this.config.formatTooltipX=t.tooltipOptions.formatTooltipX,this.config.formatTooltipY=t.tooltipOptions.formatTooltipY,this.config.valuesOverPoints=t.valuesOverPoints}prepareData(t=this.data){return Ne(t,this.type)}prepareFirstData(t=this.data){return Se(t)}calc(t=!1){this.calcXPositions(),t||this.calcYAxisParameters(this.getAllYValues(),"line"===this.type),this.makeDataByIndex()}calcXPositions(){let t=this.state,e=this.data.labels;t.datasetLength=e.length,t.unitWidth=this.width/t.datasetLength,t.xOffset=t.unitWidth/2,t.xAxis={labels:e,positions:e.map((e,s)=>S(t.xOffset+s*t.unitWidth))}}calcYAxisParameters(t,e="false"){const s=ve(t,e),i=this.height/ke(s),a=Ae(s)*i,n=this.height-we(s)*a;this.state.yAxis={labels:s,positions:s.map(t=>n-t*i),scaleMultiplier:i,zeroLine:n},this.calcDatasetPoints(),this.calcYExtremes(),this.calcYRegions()}calcDatasetPoints(){let t=this.state,e=e=>e.map(e=>Le(e,t.yAxis));t.datasets=this.data.datasets.map((t,s)=>{let i=t.values,a=t.cumulativeYs||[];return{name:t.name,index:s,chartType:t.chartType,values:i,yPositions:e(i),cumulativeYs:a,cumulativeYPos:e(a)}})}calcYExtremes(){let t=this.state;this.barOptions.stacked?t.yExtremes=t.datasets[t.datasets.length-1].cumulativeYPos:(t.yExtremes=new Array(t.datasetLength).fill(9999),t.datasets.map(e=>{e.yPositions.map((e,s)=>{e<t.yExtremes[s]&&(t.yExtremes[s]=e)})}))}calcYRegions(){let t=this.state;this.data.yMarkers&&(this.state.yMarkers=this.data.yMarkers.map(e=>(e.position=Le(e.value,t.yAxis),e.options||(e.options={}),e))),this.data.yRegions&&(this.state.yRegions=this.data.yRegions.map(e=>(e.startPos=Le(e.start,t.yAxis),e.endPos=Le(e.end,t.yAxis),e.options||(e.options={}),e)))}getAllYValues(){let t="values";if(this.barOptions.stacked){t="cumulativeYs";let e=new Array(this.state.datasetLength).fill(0);this.data.datasets.map((s,i)=>{let a=this.data.datasets[i].values;s[t]=e=e.map((t,e)=>t+a[e])})}let e=this.data.datasets.map(e=>e[t]);return this.data.yMarkers&&e.push(this.data.yMarkers.map(t=>t.value)),this.data.yRegions&&this.data.yRegions.map(t=>{e.push([t.end,t.start])}),[].concat(...e)}setupComponents(){let t=[["yAxis",{mode:this.config.yAxisMode,width:this.width,shortenNumbers:this.config.shortenYAxisNumbers},function(){return this.state.yAxis}.bind(this)],["xAxis",{mode:this.config.xAxisMode,height:this.height},function(){let t=this.state;return t.xAxis.calcLabels=Ee(this.width,t.xAxis.labels,this.config.xIsSeries),t.xAxis}.bind(this)],["yRegions",{width:this.width,pos:"right"},function(){return this.state.yRegions}.bind(this)]],e=this.state.datasets.filter(t=>"bar"===t.chartType),s=this.state.datasets.filter(t=>"line"===t.chartType),i=e.map(t=>{let s=t.index;return["barGraph-"+t.index,{index:s,color:this.colors[s],stacked:this.barOptions.stacked,valuesOverPoints:this.config.valuesOverPoints,minHeight:this.height*f},function(){let t=this.state,i=t.datasets[s],a=this.barOptions.stacked,n=this.barOptions.spaceRatio||g,r=t.unitWidth*(1-n),o=r/(a?1:e.length),l=t.xAxis.positions.map(t=>t-r/2);a||(l=l.map(t=>t+o*s));let h=new Array(t.datasetLength).fill("");this.config.valuesOverPoints&&(h=a&&i.index===t.datasets.length-1?i.cumulativeYs:i.values);let d=new Array(t.datasetLength).fill(0);return a&&(d=i.yPositions.map((t,e)=>t-i.cumulativeYPos[e])),{xPositions:l,yPositions:i.yPositions,offsets:d,labels:h,zeroLine:t.yAxis.zeroLine,barsWidth:r,barWidth:o}}.bind(this)]}),a=s.map(t=>{let e=t.index;return["lineGraph-"+t.index,{index:e,color:this.colors[e],svgDefs:this.svgDefs,heatline:this.lineOptions.heatline,regionFill:this.lineOptions.regionFill,spline:this.lineOptions.spline,hideDots:this.lineOptions.hideDots,hideLine:this.lineOptions.hideLine,valuesOverPoints:this.config.valuesOverPoints},function(){let t=this.state,s=t.datasets[e],i=t.yAxis.positions[0]<t.yAxis.zeroLine?t.yAxis.positions[0]:t.yAxis.zeroLine;return{xPositions:t.xAxis.positions,yPositions:s.yPositions,values:s.values,zeroLine:i,radius:this.lineOptions.dotSize||y}}.bind(this)]}),n=[["yMarkers",{width:this.width,pos:"right"},function(){return this.state.yMarkers}.bind(this)]];t=t.concat(i,a,n);let r=["yMarkers","yRegions"];this.dataUnitComponents=[],this.components=new Map(t.filter(t=>!r.includes(t[0])||this.state[t[0]]).map(t=>{let e=me(...t);return(t[0].includes("lineGraph")||t[0].includes("barGraph"))&&this.dataUnitComponents.push(e),[t[0],e]}))}makeDataByIndex(){this.dataByIndex={};let t=this.state,e=this.config.formatTooltipX,s=this.config.formatTooltipY;t.xAxis.labels.map((i,a)=>{let n=this.state.datasets.map((t,e)=>{let i=t.values[a];return{title:t.name,value:i,yPos:t.yPositions[a],color:this.colors[e],formatted:s?s(i):i}});this.dataByIndex[a]={label:i,formattedLabel:e?e(i):i,xPos:t.xAxis.positions[a],values:n,yExtreme:t.yExtremes[a]}})}bindTooltip(){this.container.addEventListener("mousemove",t=>{let s=this.measures,i=e(this.container),a=t.pageX-i.left-o(s),n=t.pageY-i.top;n<this.height+r(s)&&n>r(s)?this.mapTooltipXPosition(a):this.tip.hideTip()})}mapTooltipXPosition(t){let e=this.state;if(!e.yExtremes)return;let s=Pe(t,e.xAxis.positions,!0),i=this.dataByIndex[s];this.tip.setValues(i.xPos+this.tip.offset.x,i.yExtreme+this.tip.offset.y,{name:i.formattedLabel,value:""},i.values,s),this.tip.showTip()}renderLegend(){let t=this.data;t.datasets.length>1&&(this.legendArea.textContent="",t.datasets.map((t,e)=>{let s=ut(m*e,"0",m,this.colors[e],t.name,this.config.truncateLegends);this.legendArea.appendChild(s)}))}makeOverlay(){this.init?this.init=0:(this.overlayGuides&&this.overlayGuides.forEach(t=>{let e=t.overlay;e.parentNode.removeChild(e)}),this.overlayGuides=this.dataUnitComponents.map(t=>({type:t.unitType,overlay:void 0,units:t.units})),void 0===this.state.currentIndex&&(this.state.currentIndex=this.state.datasetLength-1),this.overlayGuides.map(t=>{let e=t.units[this.state.currentIndex];t.overlay=Pt[t.type](e),this.drawArea.appendChild(t.overlay)}))}updateOverlayGuides(){this.overlayGuides&&this.overlayGuides.forEach(t=>{let e=t.overlay;e.parentNode.removeChild(e)})}bindOverlay(){this.parent.addEventListener("data-select",()=>{this.updateOverlay()})}bindUnits(){this.dataUnitComponents.map(t=>{t.units.map(t=>{t.addEventListener("click",()=>{let e=t.getAttribute("data-point-index");this.setCurrentDataPoint(e)})})}),this.tip.container.addEventListener("click",()=>{let t=this.tip.container.getAttribute("data-point-index");this.setCurrentDataPoint(t)})}updateOverlay(){this.overlayGuides.map(t=>{let e=t.units[this.state.currentIndex];Tt[t.type](e,t.overlay)})}onLeftArrow(){this.setCurrentDataPoint(this.state.currentIndex-1)}onRightArrow(){this.setCurrentDataPoint(this.state.currentIndex+1)}getDataPoint(t=this.state.currentIndex){let e=this.state;return{index:t,label:e.xAxis.labels[t],values:e.datasets.map(e=>e.values[t])}}setCurrentDataPoint(t){let e=this.state;(t=parseInt(t))<0&&(t=0),t>=e.xAxis.labels.length&&(t=e.xAxis.labels.length-1),t!==e.currentIndex&&(e.currentIndex=t,a(this.parent,"data-select",this.getDataPoint()))}addDataPoint(t,e,s=this.state.datasetLength){super.addDataPoint(t,e,s),this.data.labels.splice(s,0,t),this.data.datasets.map((t,i)=>{t.values.splice(s,0,e[i])}),this.update(this.data)}removeDataPoint(t=this.state.datasetLength-1){this.data.labels.length<=1||(super.removeDataPoint(t),this.data.labels.splice(t,1),this.data.datasets.map(e=>{e.values.splice(t,1)}),this.update(this.data))}updateDataset(t,e=0){this.data.datasets[e].values=t,this.update(this.data)}updateDatasets(t){this.data.datasets.map((e,s)=>{t[s]&&(e.values=t[s])}),this.update(this.data)}}exports.AxisChart=Oe;class ze extends _t{constructor(t,e){super(t,e),this.type="donut",this.initTimeout=0,this.init=1,this.setup()}configure(t){super.configure(t),this.mouseMove=this.mouseMove.bind(this),this.mouseLeave=this.mouseLeave.bind(this),this.hoverRadio=t.hoverRadio||.1,this.config.startAngle=t.startAngle||0,this.clockWise=t.clockWise||!1,this.strokeWidth=t.strokeWidth||30}calc(){super.calc();let t=this.state;this.radius=this.height>this.width?this.center.x-this.strokeWidth/2:this.center.y-this.strokeWidth/2;const{radius:e,clockWise:s}=this,i=t.slicesProperties||[];t.sliceStrings=[],t.slicesProperties=[];let a=180-this.config.startAngle;t.sliceTotals.map((n,r)=>{const o=a,l=n/t.grandTotal*$,h=l>180?1:0,d=s?-l:l,c=a+=d,p=z(o,e),u=z(c,e),m=this.init&&i[r];let g,f;this.init?(g=m?m.startPosition:p,f=m?m.endPosition:p):(g=p,f=u);const y=360===l?ht(g,f,this.center,this.radius,this.clockWise,h):lt(g,f,this.center,this.radius,this.clockWise,h);t.sliceStrings.push(y),t.slicesProperties.push({startPosition:p,endPosition:u,value:n,total:t.grandTotal,startAngle:o,endAngle:c,angle:d})}),this.init=0}setupComponents(){let t=this.state,e=[["donutSlices",{},function(){return{sliceStrings:t.sliceStrings,colors:this.colors,strokeWidth:this.strokeWidth}}.bind(this)]];this.components=new Map(e.map(t=>{let e=me(...t);return[t[0],e]}))}calTranslateByAngle(t){const{radius:e,hoverRadio:s}=this,i=z(t.startAngle+t.angle/2,e);return`translate3d(${i.x*s}px,${i.y*s}px,0)`}hoverSlice(t,s,i,a){if(!t)return;const n=this.colors[s];if(i){Vt(t,this.calTranslateByAngle(this.state.slicesProperties[s])),t.style.stroke=j(n,50);let i=e(this.svg),r=a.pageX-i.left+10,o=a.pageY-i.top-10,l=(this.formatted_labels&&this.formatted_labels.length>0?this.formatted_labels[s]:this.state.labels[s])+": ",h=(100*this.state.sliceTotals[s]/this.state.grandTotal).toFixed(1);this.tip.setValues(r,o,{name:l,value:h+"%"}),this.tip.showTip()}else Vt(t,"translate3d(0,0,0)"),this.tip.hideTip(),t.style.stroke=n}bindTooltip(){this.container.addEventListener("mousemove",this.mouseMove),this.container.addEventListener("mouseleave",this.mouseLeave)}mouseMove(t){const e=t.target;let s=this.components.get("donutSlices").store,i=this.curActiveSliceIndex,a=this.curActiveSlice;if(s.includes(e)){let n=s.indexOf(e);this.hoverSlice(a,i,!1),this.curActiveSlice=e,this.curActiveSliceIndex=n,this.hoverSlice(e,n,!0,t)}else this.mouseLeave()}mouseLeave(){this.hoverSlice(this.curActiveSlice,this.curActiveSliceIndex,!1)}}const We={bar:Oe,line:Oe,percentage:ge,heatmap:$e,pie:fe,donut:ze};function He(t="line",e,s){return"axis-mixed"===t?(s.type="line",new Oe(e,s)):We[t]?new We[t](e,s):void console.error("Undefined chart type: "+t)}class Fe{constructor(t,e){return He(e.type,t,e)}}exports.Chart=Fe;
},{}],"CWC6":[function(require,module,exports) {

},{}],"oVQh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("date-fns/getYear")),t=require("frappe-charts/dist/frappe-charts.esm.js");function a(e){return e&&e.__esModule?e:{default:e}}require("frappe-charts/dist/frappe-charts.min.css");var r={components:{Chart:t.Chart},data:function(){return{podcasterSlug:null,currentDate:new Date,currentYear:null,yearlyStats:[0],data:{labels:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],datasets:[]}}},computed:{pageValues:function(){return this.$store.getters["content/values"](this.id)}},mounted:function(){var t=(0,e.default)(this.currentDate);this.podcasterSlug=this.sanitizeTitle(this.pageValues.podcastertitle),this.getStats(t)},methods:{getStats:function(e){var t=this;fetch("/api/podcaster/stats/"+this.podcasterSlug+"/episodes/yearly-downloads/"+e+"+"+(e-1),{method:"GET",headers:{"X-CSRF":panel.csrf}}).then(function(e){if(200!==e.status)throw"You are tracking your downloads, using the file method. Stats are currently available only when using mysql";return e}).then(function(e){return e.json()}).then(function(a){t.addChartData(a.stats,e)}).catch(function(e){t.error=e})},addChartData:function(e,t){var a={current:{name:t,values:[0,0,0,0,0,0,0,0,0,0,0,0]},past:{name:t-1,values:[0,0,0,0,0,0,0,0,0,0,0,0]}};e.map(function(e){e.year===t?a.current.values[e.month-1]=e.downloaded:a.past.values[e.month-1]=e.downloaded}),this.data.datasets=[a.current,a.past],this.drawChart()},drawChart:function(){new t.Chart("#chart",{title:"Monthly Episode Downloads",data:this.data,type:"line",height:350,colors:["green","dark-grey"],lineOptions:{hideLine:0,regionFill:1,hideDots:0},barOptions:{spaceRatio:.25}})},sanitizeTitle:function(e){return e.toLowerCase().replace(/e|é|è|ẽ|ẻ|ẹ|ê|ế|ề|ễ|ể|ệ/gi,"e").replace(/a|á|à|ã|ả|ạ|ă|ắ|ằ|ẵ|ẳ|ặ|â|ấ|ầ|ẫ|ẩ|ậ/gi,"a").replace(/o|ó|ò|õ|ỏ|ọ|ô|ố|ồ|ỗ|ổ|ộ|ơ|ớ|ờ|ỡ|ở|ợ/gi,"o").replace(/u|ú|ù|ũ|ủ|ụ|ư|ứ|ừ|ữ|ử|ự/gi,"u").replace(/đ/gi,"d").replace(/\s*$/g,"").replace(/\s+/g,"-")}}};exports.default=r;
(function(){var t=exports.default||module.exports;"function"==typeof t&&(t=t.options),Object.assign(t,{render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[this._v(" "+this._s(this.error)+" "),e("div",{attrs:{id:"chart"}})])},staticRenderFns:[],_compiled:!0,_scopeId:null,functional:void 0});})();
},{"date-fns/getYear":"y4KC","frappe-charts/dist/frappe-charts.esm.js":"PwSu","frappe-charts/dist/frappe-charts.min.css":"CWC6"}],"FOZT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=function(e){return e.toLowerCase().replace(/e|é|è|ẽ|ẻ|ẹ|ê|ế|ề|ễ|ể|ệ/gi,"e").replace(/a|á|à|ã|ả|ạ|ă|ắ|ằ|ẵ|ẳ|ặ|â|ấ|ầ|ẫ|ẩ|ậ/gi,"a").replace(/o|ó|ò|õ|ỏ|ọ|ô|ố|ồ|ỗ|ổ|ộ|ơ|ớ|ờ|ỡ|ở|ợ/gi,"o").replace(/u|ú|ù|ũ|ủ|ụ|ư|ứ|ừ|ữ|ử|ự/gi,"u").replace(/đ/gi,"d").replace(/\s*$/g,"").replace(/\s+/g,"-")},r=e;exports.default=r;
},{}],"eRgp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("../utils"));function e(t){return t&&t.__esModule?t:{default:t}}var n={data:function(){return{limit:10,headline:null,topEpisodes:[],error:null,podcasterSlug:null}},mounted:function(){this.podcasterSlug=(0,t.default)(this.pageValues.podcastertitle),this.getStats()},created:function(){var t=this;this.load().then(function(e){t.headline=e.headline})},computed:{pageValues:function(){return this.$store.getters["content/values"](this.id)}},methods:{getStats:function(){var t=this;fetch("/api/podcaster/stats/"+this.podcasterSlug+"/top/"+this.limit,{method:"GET",headers:{"X-CSRF":panel.csrf}}).then(function(t){if(200!==t.status)throw"You are tracking your downloads, using the file method. Stats are currently available only when using mysql";return t}).then(function(t){return t.json()}).then(function(e){t.topEpisodes=t.computeStats(e.stats)}).catch(function(e){t.error=e})},computeStats:function(t){return t.map(function(t){return{text:t.episode.replace(/-/g," "),info:t.downloaded,icon:{type:"file",back:"black"}}})}}};exports.default=n;
(function(){var e=exports.default||module.exports;"function"==typeof e&&(e=e.options),Object.assign(e,{render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"k-modified-section"},[s("k-text",[e._v(e._s(e.error))]),e._v(" "),s("k-headline",[e._v(e._s(e.headline))]),e._v(" "),s("k-list",{attrs:{items:e.topEpisodes}})],1)},staticRenderFns:[],_compiled:!0,_scopeId:null,functional:void 0});})();
},{"../utils":"FOZT"}],"ppPE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=r(require("date-fns/getYear")),e=require("frappe-charts/dist/frappe-charts.esm.js");require("frappe-charts/dist/frappe-charts.min.css");var a=r(require("../utils"));function r(t){return t&&t.__esModule?t:{default:t}}var s={components:{Chart:e.Chart},data:function(){return{podcasterSlug:null,currentDate:new Date,currentYear:null,yearlyStats:[0],data:{labels:["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],datasets:[]}}},computed:{pageValues:function(){return this.$store.getters["content/values"](this.id)}},mounted:function(){var e=(0,t.default)(this.currentDate);this.podcasterSlug=(0,a.default)(this.pageValues.podcastertitle),this.getStats(e)},methods:{getStats:function(t){var e=this;fetch("/api/podcaster/stats/"+this.podcasterSlug+"/feed/yearly-downloads/"+t+"+"+(t-1),{method:"GET",headers:{"X-CSRF":panel.csrf}}).then(function(t){if(200!==t.status)throw"You are tracking your downloads, using the file method. Stats are currently available only when using mysql";return t}).then(function(t){return t.json()}).then(function(a){e.addChartData(a.stats,t)}).catch(function(t){e.error=t})},addChartData:function(t,e){var a={current:{name:e,values:[0,0,0,0,0,0,0,0,0,0,0,0]},past:{name:e-1,values:[0,0,0,0,0,0,0,0,0,0,0,0]}};t.map(function(t){t.year===e?a.current.values[t.month-1]=t.downloaded:a.past.values[t.month-1]=t.downloaded}),this.data.datasets=[a.current,a.past],this.drawChart()},drawChart:function(){new e.Chart("#feedChart",{title:"Monthly Feed Downloads",data:this.data,type:"line",height:350,colors:["blue","dark-grey"],lineOptions:{hideLine:0,regionFill:1,hideDots:0},barOptions:{spaceRatio:.25}})}}};exports.default=s;
(function(){var t=exports.default||module.exports;"function"==typeof t&&(t=t.options),Object.assign(t,{render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[this._v(" "+this._s(this.error)+" "),e("div",{attrs:{id:"feedChart"}})])},staticRenderFns:[],_compiled:!0,_scopeId:null,functional:void 0});})();
},{"date-fns/getYear":"y4KC","frappe-charts/dist/frappe-charts.esm.js":"PwSu","frappe-charts/dist/frappe-charts.min.css":"CWC6","../utils":"FOZT"}],"LGl8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e={data:function(){return{headline:null,logs:[],feedItems:[],numItems:0,numRemain:0,numDownload:0,failed:0,feedName:"",currentEpisode:""}},created:function(){},mounted:function(){this.headline=this.pageValues.podcasterWizardSrcFeed},computed:{pageValues:function(){return this.$store.getters["content/values"](this.id)}},methods:{startImport:function(e){var t=this.pageValues.podcasterwizardsrcfeed;this.feedName=t,e.target.style="display: none",document.querySelector(".log").style="display: block",this.getFeed(t)},startAudioDownload:function(){this.feedItems.length>0?this.downloadAudio():this.logs.push({id:3,msg:"done"})},getFeed:function(e){var t=this;fetch("/api/podcaster/wizard/checkfeed",{method:"GET",headers:{"X-CSRF":panel.csrf,"X-FEED-URI":e}}).then(function(e){return e.json()}).then(function(e){"error"===e.status&&t.failed++;var i=void 0!==e.channel.item.length?e.channel.item.length:1;t.feedName=e.channel.title,t.numItems=i,t.numRemain=i,t.numDownload=i,t.createFeed(e.channel),t.importEpisodes(e.channel.item)}).catch(function(e){t.error=e,t.failed++})},createFeed:function(e){var t={title:e.title,link:e.link,description:e.description,itunessubtitle:e.itunessubtitle,ituneskeywords:e.ituneskeywords,itunesseason:e.itunesseason,itunesexplicit:e.itunesexplicit,itunesblock:e.itunesblock,itunestype:e.itunestype,language:e.language,copyright:e.copyright};fetch("/api/podcaster/wizard/createFeed",{method:"POST",headers:{"X-CSRF":panel.csrf,"X-TARGET-PAGE":this.pageValues.podcasterwizarddestination[0].id},body:JSON.stringify(t)}).catch(function(e){console.log(e)})},importEpisodes:function(e){if(void 0===e.length){e.title,e.link,e.pubDate,e.description,e.itunessubtitle,e.itunessummary,e.itunesduration,e.itunesseason,e.itunesexplicit,e.itunesblock,e.enclosure["@attributes"].url;this.createEpisode(e)}else for(var t=e.length-1;t>=0;t--)this.createEpisode(e[t])},createEpisode:function(e){var t=this,i={title:e.title,link:e.link,pubDate:e.pubDate,description:e.description,itunessubtitle:e.itunessubtitle,itunessummary:e.itunessummary,itunesduration:e.itunesduration,itunesseason:e.itunesseason,itunesexplicit:e.itunesexplicit,itunesblock:e.itunesblock,file:e.enclosure["@attributes"].url};fetch("/api/podcaster/wizard/createEpisode",{method:"POST",headers:{"X-CSRF":panel.csrf,"X-TARGET-PAGE":this.pageValues.podcasterwizarddestination[0].id,"X-PAGE-TEMPLATE":this.pageValues.podcasterwizardtemplate,"X-PAGE-STATUS":this.pageValues.podcasterwizardpagestatus},body:JSON.stringify(i)}).then(function(e){return e.json()}).then(function(i){t.currentEpisode=e.title,void 0!==i.status?t.numFailed++:(t.feedItems.push({title:i.title,slug:i.slug,file:i.file}),t.numRemain--,0===t.numRemain&&t.startAudioDownload())}).catch(function(e){console.log(e),t.numFailed++})},downloadAudio:function(){var e=this,t=this.feedItems[0].slug,i=this.feedItems[0].file;this.feedItems.shift(),fetch("/api/podcaster/wizard/createFile",{method:"POST",headers:{"X-CSRF":panel.csrf,"X-TARGET-PAGE":t},body:JSON.stringify({file:i})}).then(function(e){return e.json()}).then(function(t){void 0!==t.status?e.failed++:e.numDownload=e.feedItems.length,e.startAudioDownload()}).catch(function(t){console.log(t),e.failed++})}}};exports.default=e;
(function(){var t=exports.default||module.exports;"function"==typeof t&&(t=t.options),Object.assign(t,{render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("section",{staticClass:"k-modified-section podcaster-import-wizard"},[s("k-headline",[t._v(t._s(t.headline))]),t._v(" "),s("div",{staticClass:"log"},[s("div",{staticClass:"important"},[t._v("Do not close this page until the import is finished!")]),t._v(" "),s("div",{staticClass:"currentState"},[t._v("Processing »"+t._s(t.currentEpisode)+"«")]),t._v(" "),s("div",[t._v("Trying to parse »"+t._s(t.feedName)+"«")]),t._v(" "),s("div",[t._v("Found "+t._s(t.numItems)+" episodes in feed")]),t._v(" "),s("div",[t._v("creating pages, "),s("strong",[t._v(t._s(t.numRemain))]),t._v(" remaining")]),t._v(" "),s("div",[s("strong",[t._v(t._s(t.numDownload))]),t._v(" audio downloads remaining")]),t._v(" "),s("div",[t._v(t._s(t.failed)+" failed attempts")])]),t._v(" "),s("button",{staticClass:"k-button start-import",on:{click:t.startImport}},[t._v("Start import")])],1)},staticRenderFns:[],_compiled:!0,_scopeId:null,functional:void 0});})();
},{}],"Focm":[function(require,module,exports) {
"use strict";var e=u(require("./components/Episode.vue")),r=u(require("./components/YearGraph.vue")),t=u(require("./components/TopTen.vue")),a=u(require("./components/FeedStats.vue")),o=u(require("./components/Wizard.vue"));function u(e){return e&&e.__esModule?e:{default:e}}panel.plugin("mauricerenck/podcaster",{sections:{podcasterEpisodeStats:e.default,podcasterYearlyGraph:r.default,podcasterTopTen:t.default,podcasterFeedStats:a.default,podcasterWizard:o.default}});
},{"./components/Episode.vue":"w6LP","./components/YearGraph.vue":"oVQh","./components/TopTen.vue":"eRgp","./components/FeedStats.vue":"ppPE","./components/Wizard.vue":"LGl8"}]},{},["Focm"], null)